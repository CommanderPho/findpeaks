

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>API References &mdash; findpeaks findpeaks documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Coding quality" href="Coding%20quality.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> findpeaks
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Abstract.html">Abstract</a></li>
</ul>
<p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html#uninstalling">Uninstalling</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Topology.html">Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mask.html">Mask</a></li>
<li class="toctree-l1"><a class="reference internal" href="Peakdetect.html">Peakdetect</a></li>
<li class="toctree-l1"><a class="reference internal" href="Caerus.html">Caerus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Performance.html">Performance</a></li>
</ul>
<p class="caption"><span class="caption-text">Pre-processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Pre-processing.html">Interpolate/impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pre-processing.html#resize">Resize</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pre-processing.html#scale">Scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pre-processing.html#gray">Gray</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pre-processing.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Denoise.html">Denoise</a></li>
</ul>
<p class="caption"><span class="caption-text">Plots</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Plots.html">One-dimensional plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plots.html#two-dimensional-plots">Two-dimensional plots</a></li>
</ul>
<p class="caption"><span class="caption-text">Use-cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Use-cases.html">Stock Markets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Use-cases.html#sonar">SONAR</a></li>
</ul>
<p class="caption"><span class="caption-text">Code Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Coding%20quality.html">Coding quality</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">findpeaks</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API References</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/findpeaks.findpeaks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-findpeaks.utils.stats">
<span id="api-references"></span><h1>API References<a class="headerlink" href="#module-findpeaks.utils.stats" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.stats.denoise">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.stats.</span></span><span class="sig-name descname"><span class="pre">denoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fastnl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.stats.denoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Denoise input data.</p>
<p>Denoising the data is very usefull before detection of peaks. Multiple methods are implemented to denoise the data.
The bilateral filter uses a Gaussian filter in the space domain,
but it also uses one more (multiplicative) Gaussian filter component which is a function of pixel intensity differences.
The Gaussian function of space makes sure that only pixels are ‘spatial neighbors’ are considered for filtering,
while the Gaussian component applied in the intensity domain (a Gaussian function of intensity differences)
ensures that only those pixels with intensities similar to that of the central pixel (‘intensity neighbors’)
are included to compute the blurred intensity value. As a result, this method preserves edges, since for pixels lying near edges,
neighboring pixels placed on the other side of the edge, and therefore exhibiting large intensity variations when
compared to the central pixel, will not be included for blurring.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Input image data.</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>(</em><em>default : 'fastnl'</em><em>, </em><em>None to disable</em><em>)</em>) – <dl class="simple">
<dt>Filtering method to remove noise</dt><dd><ul>
<li><p>None</p></li>
<li><p>’fastnl’</p></li>
<li><p>’bilateral’</p></li>
<li><p>’lee’</p></li>
<li><p>’lee_enhanced’</p></li>
<li><p>’kuan’</p></li>
<li><p>’frost’</p></li>
<li><p>’median’</p></li>
<li><p>’mean’</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>window</strong> (<em>int</em><em>, </em><em>(</em><em>default : 3</em><em>)</em>) – Denoising window. Increasing the window size may removes noise better but may also removes details of image in certain denoising methods.</p></li>
<li><p><strong>cu</strong> (<em>float</em><em>, </em><em>(</em><em>default: 0.25</em><em>)</em>) – The noise variation coefficient, applies for methods: [‘kuan’,’lee’,’lee_enhanced’]</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> (</em><em>default : 3</em><em>)</em>) – Print to screen. 0: None, 1: Error, 2: Warning, 3: Info, 4: Debug, 5: Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong> – Denoised data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_imgproc/py_filtering/py_filtering.html">https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_imgproc/py_filtering/py_filtering.html</a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.stats.mask">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.stats.</span></span><span class="sig-name descname"><span class="pre">mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.stats.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine peaks in 2d-array using a mask.</p>
<p>Takes an image and detect the peaks using the local maximum filter.
Returns a boolean mask of the peaks (i.e. 1 when the pixel’s value is the neighborhood maximum, 0 otherwise)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Input image data.</p></li>
<li><p><strong>limit</strong> (<em>float</em><em>, </em><em>(</em><em>default : None</em><em>)</em>) – Values &gt; limit are set as regions of interest (ROI).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Xraw<span class="classifier">array-like.</span></dt><dd><p>Input image.</p>
</dd>
<dt>Xdetect<span class="classifier">array-like (same shape as input data)</span></dt><dd><p>detected peaks with respect the input image. Elements are the scores.</p>
</dd>
<dt>Xranked<span class="classifier">array-like (same shape as input data)</span></dt><dd><p>detected peaks with respect the input image. Elements are the ranked peaks (1=best).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict()</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://stackoverflow.com/questions/3684484/peak-detection-in-a-2d-array">https://stackoverflow.com/questions/3684484/peak-detection-in-a-2d-array</a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.stats.resize">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.stats.</span></span><span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.stats.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Input image data.</p></li>
<li><p><strong>size</strong> (<em>tuple</em><em>, </em><em>(</em><em>default : None</em><em>)</em>) – size to desired (width,length).</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> (</em><em>default : 3</em><em>)</em>) – Print to screen. 0: None, 1: Error, 2: Warning, 3: Info, 4: Debug, 5: Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.stats.scale">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.stats.</span></span><span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.stats.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize data (image) by scaling.</p>
<p>Scaling in range [0-255] by img*(255/max(img))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Input image data.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> (</em><em>default : 3</em><em>)</em>) – Print to screen. 0: None, 1: Error, 2: Warning, 3: Info, 4: Debug, 5: Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong> – Scaled image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.stats.togray">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.stats.</span></span><span class="sig-name descname"><span class="pre">togray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.stats.togray" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert color to grey-image.</p>
<p>Convert 3d-RGB colors to 2d-grey image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Input image data.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> (</em><em>default : 3</em><em>)</em>) – Print to screen. 0: None, 1: Error, 2: Warning, 3: Info, 4: Debug, 5: Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong> – 2d-image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.stats.topology">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.stats.</span></span><span class="sig-name descname"><span class="pre">topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.stats.topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine peaks in 2d-array using toplogy method.</p>
<p>The idea behind the topology method: Consider the function graph of the function that assigns each pixel its level.
Now consider a water level that continuously descents to lower levels. At local maxima islands pop up (birth). At saddle points two islands merge; we consider the lower island to be merged to the higher island (death). The so-called persistence diagram (of the 0-th dimensional homology classes, our islands) depicts death- over birth-values of all islands.
The persistence of an island is then the difference between the birth- and death-level; the vertical distance of a dot to the grey main diagonal. The figure labels the islands by decreasing persistence.
This method not only gives the local maxima but also quantifies their “significance” by the above mentioned persistence. One would then filter out all islands with a too low persistence. However, in your example every island (i.e., every local maximum) is a peak you look for.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like data</em>) – Input data.</p></li>
<li><p><strong>limit</strong> (<em>float</em><em>, </em><em>(</em><em>default : None</em><em>)</em>) – score &gt; limit are set as regions of interest (ROI).</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> (</em><em>default : 3</em><em>)</em>) – Print to screen. 0: None, 1: Error, 2: Warning, 3: Info, 4: Debug, 5: Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Xdetect<span class="classifier">array-like (same shape as input data)</span></dt><dd><p>detected peaks with respect the input image. Elements are the scores.</p>
</dd>
<dt>Xranked<span class="classifier">array-like (same shape as input data)</span></dt><dd><p>detected peaks with respect the input image. Elements are the ranked peaks (1=best).</p>
</dd>
<dt>max_peaks<span class="classifier">array-like</span></dt><dd><p>Detected peaks</p>
</dd>
<dt>min_peaks<span class="classifier">array-like</span></dt><dd><p>Detected vallyes</p>
</dd>
<dt>persistence<span class="classifier">DataFrame()</span></dt><dd><ul class="simple">
<li><p>x, y    : coordinates</p></li>
<li><p>birth   : Birth level</p></li>
<li><p>death   : Death level</p></li>
<li><p>score   : persistence scores</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict()</p>
</dd>
</dl>
<p class="rubric">References</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sthu.org/code/codesnippets/imagepers.html">https://www.sthu.org/code/codesnippets/imagepers.html</a></p></li>
<li><ol class="upperalpha simple" start="8">
<li><p>Edelsbrunner and J. Harer, Computational Topology. An Introduction, 2010, ISBN 0-8218-4925-5.</p></li>
</ol>
</li>
<li><p>Initial implementation: Stefan Huber &lt;<a class="reference external" href="mailto:shuber&#37;&#52;&#48;sthu&#46;org">shuber<span>&#64;</span>sthu<span>&#46;</span>org</a>&gt;</p></li>
<li><p>Editted by: Erdogan Taskesen &lt;<a class="reference external" href="mailto:erdogant&#37;&#52;&#48;gmail&#46;com">erdogant<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p></li>
</ul>
</dd></dl>

<span class="target" id="module-findpeaks.utils.interpolate"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.interpolate.interpolate_line1d">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.interpolate.</span></span><span class="sig-name descname"><span class="pre">interpolate_line1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showfig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.interpolate.interpolate_line1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate 1d-vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> (</em><em>1D-vector</em><em>)</em>) – Input image data.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>(</em><em>default : 3</em><em>)</em>) – The interpolation factor. The data is interpolation by a factor n.</p></li>
<li><p><strong>method</strong> (<em>str</em><em> (</em><em>default: 'linear'</em><em>)</em>) – <dl class="simple">
<dt>String or integer</dt><dd><ul>
<li><p>0 : order degree</p></li>
<li><p>1 : order degree</p></li>
<li><p>2 : order degree</p></li>
<li><p>3 : order degree</p></li>
<li><p>’linear’ (default)</p></li>
<li><p>’nearest’</p></li>
<li><p>’zero’</p></li>
<li><p>’slinear’</p></li>
<li><p>’quadratic’</p></li>
<li><p>’cubic’</p></li>
<li><p>’previous’</p></li>
<li><p>’next’</p></li>
</ul>
</dd>
<dt>showfig<span class="classifier">bool, (default</span><span class="classifier">False)</span></dt><dd><p>Show the figure.</p>
</dd>
</dl>
</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> (</em><em>default : 3</em><em>)</em>) – Print to screen. 0: None, 1: Error, 2: Warning, 3: Info, 4: Debug, 5: Trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>X</strong> – Interpolated data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like (1D-vector)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.interpolate.interpolate_line2d">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.interpolate.</span></span><span class="sig-name descname"><span class="pre">interpolate_line2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.interpolate.interpolate_line2d" title="Permalink to this definition">¶</a></dt>
<dd><p>interpolate 2D vector.</p>
<p>Smoothing a 2d vector can be challanging if the data is low sampled.
This function contains two steps. First interpolation of the input line followed by a convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>array-like</em>) – Data points for the x-axis.</p></li>
<li><p><strong>ys</strong> (<em>array-like</em>) – Data points for the y-axis.</p></li>
<li><p><strong>interpol</strong> (<em>int</em><em>, </em><em>(</em><em>default : 3</em><em>)</em>) – The interpolation factor. The data is interpolation by a factor n before the smoothing step.</p></li>
<li><p><strong>window</strong> (<em>int</em><em>, </em><em>(</em><em>default : 3</em><em>)</em>) – Smoothing window that is used to create the convolution and gradually smoothen the line.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> [</em><em>1-5</em><em>]</em><em>, </em><em>default: 3</em>) – Print information to screen. A higher number will print more.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xnew</strong> (<em>array-like</em>) – Data points for the x-axis.</p></li>
<li><p><strong>ynew</strong> (<em>array-like</em>) – Data points for the y-axis.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.interpolate.interpolate_nans">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.interpolate.</span></span><span class="sig-name descname"><span class="pre">interpolate_nans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value_to_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.interpolate.interpolate_nans" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the nan values in an 1D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – input data X.</p></li>
<li><p><strong>replace_value_to_nan</strong> (<em>float</em><em> (</em><em>default: None</em><em>)</em>) – Replace value to np.nan.
* None : take finite data: interplate np.nan.
* 0 : take np.nan with the additional value (alternative)</p></li>
<li><p><strong>method</strong> (<em>str</em><em> (</em><em>default: 'linear'</em><em>)</em>) – String or integer
* 0 : order degree
* 1 : order degree
* 2 : order degree
* 3 : order degree
* ‘linear’ (default)
* ‘nearest’
* ‘zero’
* ‘slinear’
* ‘quadratic’
* ‘cubic’
* ‘previous’
* ‘next’</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em> ( </em><em>default is 3</em><em>)</em>) – Print message to screen. A higher number will increase outputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xint1</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Xint2</span> <span class="o">=</span> <span class="n">interpolate_nans</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.utils.interpolate.plot">
<span class="sig-prename descclassname"><span class="pre">findpeaks.utils.interpolate.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.utils.interpolate.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-findpeaks.filters.frost"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.frost.calculate_all_Mi">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.frost.</span></span><span class="sig-name descname"><span class="pre">calculate_all_Mi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.frost.calculate_all_Mi" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all the weights of pixels in the window.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.frost.calculate_local_weight_matrix">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.frost.</span></span><span class="sig-name descname"><span class="pre">calculate_local_weight_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_A</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.frost.calculate_local_weight_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array with the weights for the pixels in the given window.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.frost.compute_coef_var">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.frost.</span></span><span class="sig-name descname"><span class="pre">compute_coef_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.frost.compute_coef_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute coefficient of variation in a window of [x_start: x_end] and
[y_start:y_end] within the image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.frost.frost_filter">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.frost.</span></span><span class="sig-name descname"><span class="pre">frost_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.frost.frost_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply frost filter to a numpy matrix containing the image, with a window of
win_size x win_size.
By default, the window size is 3x3.</p>
</dd></dl>

<span class="target" id="module-findpeaks.filters.lee"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.lee.lee_filter">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.lee.</span></span><span class="sig-name descname"><span class="pre">lee_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.lee.lee_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply lee to a numpy matrix containing the image, with a window of
win_size x win_size.</p>
<p>The Additive Noise Lee Despeckling Filter
Let’s assume that the despeckling noise is additive with a constant mean of zero, a constant variance, and drawn from a Gaussian distribution. Use a window (I x J pixels) to scan the image with a stride of 1 pixels (and I will use reflective boundary conditions). The despeckled value of the pixel in the center of the window located in the ith row and jth column is, zhat_ij = mu_k + W*(z_ij = mu_z), where mu_k is the mean value of all pixels in the window centered on pixel i,j, z_ij is the unfiltered value of the pixel, and W is a weight calculated as, W = var_k / (var_k + var_noise), where var_k is the variance of all pixels in the window and var_noise is the variance of the speckle noise. A possible alternative to using the actual value of the center pixel for z_ij is to use the median pixel value in the window.
The parameters of the filter are the window/kernel size and the variance of the noise (which is unknown but can perhaps be estimated from the image as the variance over a uniform feature smooth like the surface of still water). Using a larger window size and noise variance will increase radiometric resolution at the expense of spatial resolution.
For more info on the Lee Filter and other despeckling filters see <a class="reference external" href="http://desktop.arcgis.com/en/arcmap/10.3/manage-data/raster-and-images/speckle-function.htm">http://desktop.arcgis.com/en/arcmap/10.3/manage-data/raster-and-images/speckle-function.htm</a>
Assumes noise mean = 0
If you don’t want the window to be a square of size x size, just replace uniform_filter with something else (convolution with a disk, gaussian filter, etc). Any type of (weighted) averaging filter will do, as long as it is the same for calculating both img_mean and img_square_mean.
The Lee filter seems rather old-fashioned as a filter. It won’t behave well at edges because for any window that has an edge in it, the variance is going to be much higher than the overall image variance, and therefore the weights (of the unfiltered image relative to the filtered image) are going to be close to 1.</p>
</dd></dl>

<span class="target" id="module-findpeaks.filters.kuan"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.kuan.kuan_filter">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.kuan.</span></span><span class="sig-name descname"><span class="pre">kuan_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.kuan.kuan_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply kuan to a numpy matrix containing the image, with a window of
win_size x win_size.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.kuan.weighting">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.kuan.</span></span><span class="sig-name descname"><span class="pre">weighting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.kuan.weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weighthing function for Kuan filter using cu as the noise
coefficient.</p>
</dd></dl>

<span class="target" id="module-findpeaks.filters.lee_enhanced"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.lee_enhanced.assert_parameters">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.lee_enhanced.</span></span><span class="sig-name descname"><span class="pre">assert_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">win_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.lee_enhanced.assert_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Asserts parameters in range.
Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>k: in [0:10]</p></li>
<li><p>cu: positive</p></li>
<li><p>cmax: positive and greater equal than cu</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.lee_enhanced.lee_enhanced_filter">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.lee_enhanced.</span></span><span class="sig-name descname"><span class="pre">lee_enhanced_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.523</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.73</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.lee_enhanced.lee_enhanced_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Enhanced Lee filter to a numpy matrix containing the image, with a
window of win_size x win_size.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.lee_enhanced.weighting">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.lee_enhanced.</span></span><span class="sig-name descname"><span class="pre">weighting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pix_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.523</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.73</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.lee_enhanced.weighting" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the weighthing function for Lee filter using cu as the noise
coefficient.</p>
</dd></dl>

<span class="target" id="module-findpeaks.filters.mean"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.mean.assert_indices_in_range">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.mean.</span></span><span class="sig-name descname"><span class="pre">assert_indices_in_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xleft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xright</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydown</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.mean.assert_indices_in_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Asserts index out of image range.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.mean.mean_filter">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.mean.</span></span><span class="sig-name descname"><span class="pre">mean_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.mean.mean_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a ‘mean filter’ to ‘img’ with a window size equal to ‘win_size’.
Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>img: a numpy matrix representing the image.</p></li>
<li><p>win_size: the size of the windows (by default 3).</p></li>
</ul>
</div></blockquote>
</dd></dl>

<span class="target" id="module-findpeaks.filters.median"></span><dl class="py function">
<dt class="sig sig-object py" id="findpeaks.filters.median.median_filter">
<span class="sig-prename descclassname"><span class="pre">findpeaks.filters.median.</span></span><span class="sig-name descname"><span class="pre">median_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#findpeaks.filters.median.median_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a ‘median filter’ to ‘img’ with a window size equal to ‘win_size’.
Parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>img: a numpy matrix representing the image.</p></li>
<li><p>win_size: the size of the windows (by default 3)</p></li>
</ul>
</div></blockquote>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Coding%20quality.html" class="btn btn-neutral float-left" title="Coding quality" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Erdogan Taskesen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>